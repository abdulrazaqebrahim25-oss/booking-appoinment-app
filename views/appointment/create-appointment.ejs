<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Appointment</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <%- include('../navbar') %>

    <div class="container auth-container">
        <h1>Create Appointment</h1>

        <form action="/appointment/new" method="post" class="auth-form">

            <div class="input-group">
                <label class="label" for="date">Date</label>
                <input type="date" name="date" id="date" class="input" required>
            </div>

            <div class="input-group">
                <label class="label" for="time">Time</label>
                <input type="time" name="time" id="time" class="input" required>
            </div>

            <div class="input-group">
                <label class="label" for="service">Service</label>
                <select name="service" id="service" class="select" required>
                    <option value="" disabled selected>Select a service</option>
                    <% service.forEach((oneService) => { %>
                        <option value="<%= oneService._id %>"><%= oneService.service %></option>
                    <% }) %>
                </select>
            </div>

            <div class="input-group">
                <label class="label" for="price">Price</label>
                <select name="price" id="price" class="select" required>
                    <option value="" disabled selected>Select a service first</option>
                </select>
            </div>

            <div class="input-group">
                <label class="label" for="provider">Provider</label>
                <select name="provider" id="provider" class="select" required>
                    <option value="" disabled selected>Select a service first</option>
                </select>
            </div>

            <button type="submit" class="sign-inBtn">
                <span class="label">Create Appointment</span>
                <span class="gradient"></span>
                <span class="transition"></span>
            </button>

        </form>

        <div style="text-align:center; margin-top:1.5rem;">
            <a href="/appointment" class="btn btn-secondary">Back to Appointments</a>
        </div>
    </div>

    <script>
 
        const serviceSelect = document.getElementById('service');
        const priceSelect = document.getElementById('price');
        const providerSelect = document.getElementById('provider');

        const services = JSON.parse('<%- JSON.stringify(service || []) %>');

        serviceSelect.addEventListener('change', () => {
            const selectedId = serviceSelect.value;
            const selectedService = services.find(s => s._id === selectedId);


            priceSelect.innerHTML = `<option value="${selectedService._id}">${selectedService.price} BD</option>`;

            providerSelect.innerHTML = `<option value="${selectedService.provider._id}">${selectedService.provider.name}</option>`;
        });
    </script>

</body>
</html>
